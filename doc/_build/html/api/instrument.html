

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>refl1d.instrument - Reflectivity instrument definition &mdash; Refl1D v0.6.19 documentation</title>
    <link rel="stylesheet" href="../_static/haiku-site.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.6.19',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/MathJax/MathJax.js"></script>
    <script type="text/javascript" src="../_static/theme_extras.js"></script>
    <link rel="top" title="Refl1D v0.6.19 documentation" href="../index.html" />
    <link rel="up" title="Reference" href="index.html" />
    <link rel="next" title="refl1d.magnetic - Magnetic Models" href="magnetic.html" />
    <link rel="prev" title="refl1d.initpop - Population initialization strategies" href="initpop.html" /> 
  </head>
  <body>
      <div class="header"><img class="rightlogo" src="../_static/logo.png" alt="Logo"/><h1 class="heading"><a href="../index.html">
          <span>Refl1D v0.6.19 documentation</span></a></h1>
        <h2 class="heading"><span>refl1d.instrument - Reflectivity instrument definition</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="initpop.html">refl1d.initpop - Population initialization strategies</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="magnetic.html">refl1d.magnetic - Magnetic Models</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="refl1d-instrument-reflectivity-instrument-definition">
<h1>refl1d.instrument - Reflectivity instrument definition<a class="headerlink" href="#refl1d-instrument-reflectivity-instrument-definition" title="Permalink to this headline">¶</a></h1>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr><td><a class="reference internal" href="#refl1d.instrument.Monochromatic" title="refl1d.instrument.Monochromatic"><tt class="xref py py-obj docutils literal"><span class="pre">Monochromatic</span></tt></a></td>
<td>Instrument representation for scanning reflectometers.</td>
</tr>
<tr><td><a class="reference internal" href="#refl1d.instrument.Pulsed" title="refl1d.instrument.Pulsed"><tt class="xref py py-obj docutils literal"><span class="pre">Pulsed</span></tt></a></td>
<td>Instrument representation for pulsed reflectometers.</td>
</tr>
</tbody>
</table>
<span class="target" id="module-refl1d.instrument"></span><p>Reflectometry instrument definitions.</p>
<p>An instrument definition contains all the information necessary to compute
the resolution for a measurement.  See <tt class="xref py py-mod docutils literal"><span class="pre">resolution</span></tt> for details.</p>
<p>This module is intended to help define new instrument loaders</p>
<div class="section" id="scanning-reflectometers">
<h2>Scanning Reflectometers<a class="headerlink" href="#scanning-reflectometers" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#module-refl1d.instrument" title="refl1d.instrument"><tt class="xref py py-mod docutils literal"><span class="pre">refl1d.instrument</span></tt></a> (this module) defines two instrument types:
<a class="reference internal" href="#refl1d.instrument.Monochromatic" title="refl1d.instrument.Monochromatic"><tt class="xref py py-class docutils literal"><span class="pre">Monochromatic</span></tt></a> and <a class="reference internal" href="#refl1d.instrument.Pulsed" title="refl1d.instrument.Pulsed"><tt class="xref py py-class docutils literal"><span class="pre">Pulsed</span></tt></a>. These represent
generic scanning and time of flight instruments, respectively.</p>
<p>To perform a simulation or load a data set, a measurement geometry must
be defined.  In the following example, we set up the geometry for a
pretend instrument SP:2. The complete geometry needs to include information
to calculate wavelength resolution (wavelength and wavelength dispersion)
as well as angular resolution (slit distances and openings, and perhaps
sample size and sample warp).  In this case, we are using a scanning
monochromatic instrument with slits of 0.1 mm below 0.5° and
opening slits  above 0.5° starting at 0.2 mm.  The monochromatic
instrument assumes a fixed <span class="math">\Delta \theta / \theta</span> while opening.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">refl1d.names</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">Monochromatic</span><span class="p">(</span><span class="n">instrument</span><span class="o">=</span><span class="s">&quot;SP:2&quot;</span><span class="p">,</span> <span class="n">radiation</span><span class="o">=</span><span class="s">&quot;neutron&quot;</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">wavelength</span><span class="o">=</span><span class="mf">5.0042</span><span class="p">,</span> <span class="n">dLoL</span><span class="o">=</span><span class="mf">0.009</span><span class="p">,</span> <span class="n">d_s1</span><span class="o">=</span><span class="mf">230</span><span class="o">+</span><span class="mf">1856</span><span class="p">,</span> <span class="n">d_s2</span><span class="o">=</span><span class="mf">230</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">Tlo</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">slits_at_Tlo</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">slits_below</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>This instrument can be used to  a data file, or generate a
measurement probe for use in modeling or to read in a previously
measured data set or generate a probe for simulation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">loadtxt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datafile</span> <span class="o">=</span> <span class="n">sample_data</span><span class="p">(</span><span class="s">&#39;10ndt001.refl&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">dR</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probe</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">dR</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulation</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">51</span><span class="p">))</span>
</pre></div>
</div>
<p>All instrument parameters can be specified when constructing the probe,
replacing the defaults that are associated with the instrument.  For
example, to include sample broadening effects in the resolution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">probe2</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">dR</span><span class="p">),</span> <span class="n">sample_broadening</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>For magnetic systems a polarized beam probe is needed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">magnetic_probe</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">magnetic_probe</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="mf">5</span><span class="p">,</span><span class="mf">100</span><span class="p">))</span>
</pre></div>
</div>
<p>The string representation of the geometry prints a multi-line
description of the default instrument configuration:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">geometry</span>
<span class="go">== Instrument SP:2 ==</span>
<span class="go">radiation = neutron at 5.0042 Angstrom with 0.9% resolution</span>
<span class="go">slit distances = 2086 mm and 230 mm</span>
<span class="go">fixed region below 0.5 and above 90 degrees</span>
<span class="go">slit openings at Tlo are 0.2 mm</span>
<span class="go">sample width = 1e+10 mm</span>
<span class="go">sample broadening = 0 degrees</span>
</pre></div>
</div>
</div>
<div class="section" id="predefined-instruments">
<h2>Predefined Instruments<a class="headerlink" href="#predefined-instruments" title="Permalink to this headline">¶</a></h2>
<p>Specific instruments can be defined for each facility.  This saves the users
having to remember details of the instrument geometry.</p>
<p>For example, the above SP:2 instrument could be defined as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SP2</span><span class="p">(</span><span class="n">Monochromatic</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">instrument</span> <span class="o">=</span> <span class="s">&quot;SP:2&quot;</span>
<span class="gp">... </span>   <span class="n">radiation</span> <span class="o">=</span> <span class="s">&quot;neutron&quot;</span>
<span class="gp">... </span>   <span class="n">wavelength</span> <span class="o">=</span> <span class="mf">5.0042</span>   <span class="c"># Angstroms</span>
<span class="gp">... </span>   <span class="n">dLoL</span> <span class="o">=</span> <span class="mf">0.009</span>          <span class="c"># FWHM</span>
<span class="gp">... </span>   <span class="n">d_s1</span> <span class="o">=</span> <span class="mf">230.0</span> <span class="o">+</span> <span class="mf">1856.0</span> <span class="c"># mm</span>
<span class="gp">... </span>   <span class="n">d_s2</span> <span class="o">=</span> <span class="mf">230.0</span>          <span class="c"># mm</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<span class="gp">... </span>       <span class="n">Q</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">dR</span> <span class="o">=</span> <span class="n">loadtxt</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="gp">... </span>       <span class="n">probe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">dR</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="n">probe</span>
</pre></div>
</div>
<p>This definition can then be used to define the measurement geometry.  We
have added a load method which knows about the facility file format (in
this case, three column ASCII data Q, R, dR) so that we can load a datafile
in a couple of lines of code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">geometry</span> <span class="o">=</span> <span class="n">SP2</span><span class="p">(</span><span class="n">Tlo</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">slits_at_Tlo</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">slits_below</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probe3</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>
</pre></div>
</div>
<p>The defaults() method prints the static components of the geometry:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">SP2</span><span class="o">.</span><span class="n">defaults</span><span class="p">()</span>
<span class="go">== Instrument class SP:2 ==</span>
<span class="go">radiation = neutron at 5.0042 Angstrom with 0.9% resolution</span>
<span class="go">slit distances = 2086 mm and 230 mm</span>
</pre></div>
</div>
</div>
<div class="section" id="gui-usage">
<h2>GUI Usage<a class="headerlink" href="#gui-usage" title="Permalink to this headline">¶</a></h2>
<p>Graphical user interfaces follow different usage patterns from scripts.
Here the emphasis will be on selecting a data set to process, displaying
its default metadata and allowing the user to override it.</p>
<p>File loading should follow the pattern established in reflectometry
reduction, with an extension registry and a fallback scheme whereby
files can be checked in a predefined order.  If the file cannot be
loaded, then the next loader is tried.  This should be extended with
the concept of a magic signature such as those used by graphics and
sound file applications: read the first block and run it through
the signature check before trying to load it.  For unrecognized
extensions, all loaders can be tried.</p>
<p>The file loader should return an instrument instance with metadata
initialized from the file header.  This metadata can be displayed
to the user along with a plot of the data and the resolution.  When
metadata values are changed, the resolution can be recomputed and the
display updated.  When the data set is accepted, the final resolution
calculation can be performed.</p>
<dl class="class">
<dt id="refl1d.instrument.Monochromatic">
<em class="property">class </em><tt class="descclassname">refl1d.instrument.</tt><tt class="descname">Monochromatic</tt><big>(</big><em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Monochromatic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Monochromatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Instrument representation for scanning reflectometers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><dl class="first last docutils">
<dt><em>instrument</em> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">name of the instrument</p>
</dd>
<dt><em>radiation</em> <span class="classifier-delimiter">:</span> <span class="classifier">string | xray or neutron</span></dt>
<dd><p class="first last">source radiation type</p>
</dd>
<dt><em>d_s1</em>, <em>d_s2</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | mm</span></dt>
<dd><p class="first last">distance from sample to pre-sample slits 1 and 2; post-sample
slits are ignored</p>
</dd>
<dt><em>wavelength</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | Å</span></dt>
<dd><p class="first last">wavelength of the instrument</p>
</dd>
<dt><em>dLoL</em> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">constant relative wavelength dispersion; wavelength range and
dispersion together determine the bins</p>
</dd>
<dt><em>slits</em> <span class="classifier-delimiter">:</span> <span class="classifier">float OR (float,float) | mm</span></dt>
<dd><p class="first last">fixed slits</p>
</dd>
<dt><em>slits_at_Tlo</em> <span class="classifier-delimiter">:</span> <span class="classifier">float OR (float,float) | mm</span></dt>
<dd><p class="first last">slit 1 and slit 2 openings at Tlo; this can be a scalar if both
slits are open by the same amount, otherwise it is a pair (s1,s2).</p>
</dd>
<dt><em>slits_at_Qlo</em> <span class="classifier-delimiter">:</span> <span class="classifier">float OR (float,float) | mm</span></dt>
<dd><p class="first last">equivalent to slits_at_Tlo, for instruments that are controlled by
Q rather than theta</p>
</dd>
<dt><em>Tlo</em>, <em>Thi</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | °</span></dt>
<dd><p class="first last">range of opening slits, or inf if slits are fixed.</p>
</dd>
<dt><em>Qlo</em>, <em>Qhi</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | Å<sup>-1</sup></span></dt>
<dd><p class="first last">range of opening slits when instrument is controlled by Q.</p>
</dd>
<dt><em>slits_below</em>, <em>slits_above</em> <span class="classifier-delimiter">:</span> <span class="classifier">float OR (float,float) | mm</span></dt>
<dd><p class="first last">slit 1 and slit 2 openings below Tlo and above Thi; again, these
can be scalar if slit 1 and slit 2 are the same, otherwise they
are each a pair (s1,s2).  Below and above default to the values of
the slits at Tlo and Thi respectively.</p>
</dd>
<dt><em>sample_width</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | mm</span></dt>
<dd><p class="first last">width of sample; at low angle with tiny samples, stray neutrons
miss the sample and are not reflected onto the detector, so the
sample itself acts as a slit, therefore the width of the sample
may be needed to compute the resolution correctly</p>
</dd>
<dt><em>sample_broadening</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | ° FWHM</span></dt>
<dd><p class="first last">amount of angular divergence (+) or focusing (-) introduced by
the sample; this is caused by sample warp, and may be read off
of the rocking curve by subtracting (s1+s2)/2/(d_s1-d_s2) from
the FWHM width of the rocking curve</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="refl1d.instrument.Monochromatic.calc_dT">
<tt class="descname">calc_dT</tt><big>(</big><em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Monochromatic.calc_dT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Monochromatic.calc_dT" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the angular divergence for given slits and angles</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><dl class="first docutils">
<dt><em>T</em> OR <em>Q</em> <span class="classifier-delimiter">:</span> <span class="classifier">[float] | ° OR Å<sup>-1</sup></span></dt>
<dd><p class="first last">measurement angles</p>
</dd>
<dt><em>slits</em> <span class="classifier-delimiter">:</span> <span class="classifier">float OR (float,float) | mm</span></dt>
<dd><p class="first last">total slit opening from edge to edge, not beam center to edge</p>
</dd>
<dt><em>d_s1</em>, <em>d_s2</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | mm</span></dt>
<dd><p class="first last">distance from sample to slit 1 and slit 2</p>
</dd>
<dt><em>sample_width</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | mm</span></dt>
<dd><p class="first last">size of sample</p>
</dd>
<dt><em>sample_broadening</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | ° FWHM</span></dt>
<dd><p class="first last">resolution changes from sample warp</p>
</dd>
</dl>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><dl class="first last docutils">
<dt><em>dT</em> <span class="classifier-delimiter">:</span> <span class="classifier">[float] | ° FWHM</span></dt>
<dd><p class="first last">angular divergence</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p><em>sample_broadening</em> can be estimated from W, the full width at half
maximum of a rocking curve measured in degrees:</p>
<blockquote>
sample_broadening = W - degrees( 0.5*(s1+s2) / (d1-d2))</blockquote>
</dd></dl>

<dl class="method">
<dt id="refl1d.instrument.Monochromatic.calc_slits">
<tt class="descname">calc_slits</tt><big>(</big><em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Monochromatic.calc_slits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Monochromatic.calc_slits" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines slit openings from measurement pattern.</p>
<p>If slits are fixed simply return the same slits for every angle,
otherwise use an opening range [Tlo,Thi] and the value of the
slits at the start of the opening to define the slits.  Slits
below Tlo and above Thi can be specified separately.</p>
<p><em>T</em> OR <em>Q</em>       incident angle or Q
<em>Tlo</em>, <em>Thi</em>     angle range over which slits are opening
<em>slits_at_Tlo</em>   openings at the start of the range, or fixed opening
<em>slits_below</em>, <em>slits_above</em>   openings below and above the range</p>
<p>Use fixed_slits is available, otherwise use opening slits.</p>
</dd></dl>

<dl class="classmethod">
<dt id="refl1d.instrument.Monochromatic.defaults">
<em class="property">classmethod </em><tt class="descname">defaults</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Monochromatic.defaults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Monochromatic.defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Return default instrument properties as a printable string.</p>
</dd></dl>

<dl class="method">
<dt id="refl1d.instrument.Monochromatic.magnetic_probe">
<tt class="descname">magnetic_probe</tt><big>(</big><em>Aguide=270</em>, <em>shared_beam=True</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Monochromatic.magnetic_probe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Monochromatic.magnetic_probe" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate a polarized measurement probe.</p>
<p>Returns a probe with Q, angle, wavelength and the associated
uncertainties, but not any data.</p>
<p>Guide field angle <em>Aguide</em> can be specified, as well as keyword
arguments for the geometry of the probe cross sections such as
<em>slits_at_Tlo</em>, <em>Tlo</em>, <em>Thi</em>, <em>slits_below</em>, and <em>slits_above</em>
to define the angular divergence.</p>
</dd></dl>

<dl class="method">
<dt id="refl1d.instrument.Monochromatic.probe">
<tt class="descname">probe</tt><big>(</big><em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Monochromatic.probe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Monochromatic.probe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a probe for use in simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><dl class="first last docutils">
<dt><em>Q</em> <span class="classifier-delimiter">:</span> <span class="classifier">[float] | Å</span></dt>
<dd><p class="first last">Q values to be measured.</p>
</dd>
<dt><em>T</em> <span class="classifier-delimiter">:</span> <span class="classifier">[float] | °</span></dt>
<dd><p class="first last">Angles to be measured.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>Additional keyword parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><dl class="first last docutils">
<dt><em>probe</em> <span class="classifier-delimiter">:</span> <span class="classifier">Probe</span></dt>
<dd><p class="first last">Measurement probe with complete resolution information.  The
probe will not have any data.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>If both <em>Q</em> and <em>T</em> are specified then <em>Q</em> takes precedents.</p>
<p>You can override instrument parameters using key=value.  In
particular, settings for <em>slits_at_Tlo</em>, <em>Tlo</em>, <em>Thi</em>,
<em>slits_below</em>, and <em>slits_above</em> are used to define the
angular divergence.</p>
</dd></dl>

<dl class="method">
<dt id="refl1d.instrument.Monochromatic.resolution">
<tt class="descname">resolution</tt><big>(</big><em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Monochromatic.resolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Monochromatic.resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate resolution at each angle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Return :</th><td class="field-body"><dl class="first last docutils">
<dt><em>T</em>, <em>dT</em> <span class="classifier-delimiter">:</span> <span class="classifier">[float] | °</span></dt>
<dd><p class="first last">Angles and angular divergence.</p>
</dd>
<dt><em>L</em>, <em>dL</em> <span class="classifier-delimiter">:</span> <span class="classifier">[float] | Å</span></dt>
<dd><p class="first last">Wavelengths and wavelength dispersion.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="refl1d.instrument.Pulsed">
<em class="property">class </em><tt class="descclassname">refl1d.instrument.</tt><tt class="descname">Pulsed</tt><big>(</big><em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Pulsed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Pulsed" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Instrument representation for pulsed reflectometers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><dl class="first last docutils">
<dt><em>instrument</em> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">name of the instrument</p>
</dd>
<dt><em>radiation</em> <span class="classifier-delimiter">:</span> <span class="classifier">string | xray, neutron</span></dt>
<dd><p class="first last">source radiation type</p>
</dd>
<dt><em>TOF_range</em> <span class="classifier-delimiter">:</span> <span class="classifier">(float, float)</span></dt>
<dd><p class="first last">usabe range of times for TOF data</p>
</dd>
<dt><em>T</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | °</span></dt>
<dd><p class="first last">sample angle</p>
</dd>
<dt><em>d_s1</em>, <em>d_s2</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | mm</span></dt>
<dd><p class="first last">distance from sample to pre-sample slits 1 and 2; post-sample
slits are ignored</p>
</dd>
<dt><em>wavelength</em> <span class="classifier-delimiter">:</span> <span class="classifier">(float,float) | Å</span></dt>
<dd><p class="first last">wavelength range for the measurement</p>
</dd>
<dt><em>dLoL</em> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">constant relative wavelength dispersion; wavelength range and
dispersion together determine the bins</p>
</dd>
<dt><em>slits</em> <span class="classifier-delimiter">:</span> <span class="classifier">float OR (float,float) | mm</span></dt>
<dd><p class="first last">fixed slits</p>
</dd>
<dt><em>slits_at_Tlo</em> <span class="classifier-delimiter">:</span> <span class="classifier">float OR (float,float) | mm</span></dt>
<dd><p class="first last">slit 1 and slit 2 openings at Tlo; this can be a scalar if both
slits are open by the same amount, otherwise it is a pair (s1,s2).</p>
</dd>
<dt><em>Tlo</em>, <em>Thi</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | °</span></dt>
<dd><p class="first last">range of opening slits, or inf if slits are fixed.</p>
</dd>
<dt><em>slits_below</em>, <em>slits_above</em> <span class="classifier-delimiter">:</span> <span class="classifier">float OR (float,float) | mm</span></dt>
<dd><p class="first last">slit 1 and slit 2 openings below Tlo and above Thi; again, these
can be scalar if slit 1 and slit 2 are the same, otherwise they
are each a pair (s1,s2).  Below and above default to the values of
the slits at Tlo and Thi respectively.</p>
</dd>
<dt><em>sample_width</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | mm</span></dt>
<dd><p class="first last">width of sample; at low angle with tiny samples, stray neutrons
miss the sample and are not reflected onto the detector, so the
sample itself acts as a slit, therefore the width of the sample
may be needed to compute the resolution correctly</p>
</dd>
<dt><em>sample_broadening</em> <span class="classifier-delimiter">:</span> <span class="classifier">float | ° FWHM</span></dt>
<dd><p class="first last">amount of angular divergence (+) or focusing (-) introduced by
the sample; this is caused by sample warp, and may be read off
of the rocking curve by subtracting 0.5*(s1+s2)/(d_s1-d_s2) from
the FWHM width of the rocking curve</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="refl1d.instrument.Pulsed.calc_dT">
<tt class="descname">calc_dT</tt><big>(</big><em>T</em>, <em>slits</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Pulsed.calc_dT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Pulsed.calc_dT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="refl1d.instrument.Pulsed.calc_slits">
<tt class="descname">calc_slits</tt><big>(</big><em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Pulsed.calc_slits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Pulsed.calc_slits" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines slit openings from measurement pattern.</p>
<p>If slits are fixed simply return the same slits for every angle,
otherwise use an opening range [Tlo,Thi] and the value of the
slits at the start of the opening to define the slits.  Slits
below Tlo and above Thi can be specified separately.</p>
<p><em>T</em>              incident angle
<em>Tlo</em>, <em>Thi</em>     angle range over which slits are opening
<em>slits_at_Tlo</em>   openings at the start of the range, or fixed opening
<em>slits_below</em>, <em>slits_above</em>   openings below and above the range</p>
<p>Use fixed_slits is available, otherwise use opening slits.</p>
</dd></dl>

<dl class="classmethod">
<dt id="refl1d.instrument.Pulsed.defaults">
<em class="property">classmethod </em><tt class="descname">defaults</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Pulsed.defaults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Pulsed.defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>Return default instrument properties as a printable string.</p>
</dd></dl>

<dl class="method">
<dt id="refl1d.instrument.Pulsed.magnetic_probe">
<tt class="descname">magnetic_probe</tt><big>(</big><em>Aguide=270</em>, <em>shared_beam=True</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Pulsed.magnetic_probe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Pulsed.magnetic_probe" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate a polarized measurement probe.</p>
<p>Returns a probe with Q, angle, wavelength and the associated
uncertainties, but not any data.</p>
<p>Guide field angle <em>Aguide</em> can be specified, as well as keyword
arguments for the geometry of the probe cross sections such as
slit settings <em>slits</em> and <em>T</em> to define the angular divergence
and <em>dLoL</em> to define the wavelength resolution.</p>
</dd></dl>

<dl class="method">
<dt id="refl1d.instrument.Pulsed.probe">
<tt class="descname">probe</tt><big>(</big><em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Pulsed.probe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Pulsed.probe" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate a measurement probe.</p>
<p>Returns a probe with Q, angle, wavelength and the associated
uncertainties, but not any data.</p>
<p>You can override instrument parameters using key=value.
In particular, slit settings <em>slits</em> and <em>T</em> define
the angular divergence and <em>dLoL</em> defines the wavelength
resolution.</p>
</dd></dl>

<dl class="method">
<dt id="refl1d.instrument.Pulsed.resolution">
<tt class="descname">resolution</tt><big>(</big><em>L</em>, <em>dL</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Pulsed.resolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Pulsed.resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the resolution of the measurement.  Needs <em>T</em>, <em>L</em>, <em>dL</em>
specified as keywords.</p>
</dd></dl>

<dl class="method">
<dt id="refl1d.instrument.Pulsed.simulate">
<tt class="descname">simulate</tt><big>(</big><em>sample</em>, <em>uncertainty=1</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../_modules/refl1d/instrument.html#Pulsed.simulate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#refl1d.instrument.Pulsed.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate a run with a particular sample.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><dl class="first last docutils">
<dt><em>sample</em> <span class="classifier-delimiter">:</span> <span class="classifier">Stack</span></dt>
<dd><p class="first last">Reflectometry model</p>
</dd>
<dt><em>T</em> <span class="classifier-delimiter">:</span> <span class="classifier">[float] | °</span></dt>
<dd><p class="first last">List of angles to be measured, such as [0.15,0.4,1,2].</p>
</dd>
<dt><em>slits</em> <span class="classifier-delimiter">:</span> <span class="classifier">[float] or [(float,float)] | mm</span></dt>
<dd><p class="first last">Slit settings for each angle.</p>
</dd>
<dt><em>uncertainty</em> = 1 <span class="classifier-delimiter">:</span> <span class="classifier">float or [float] | %</span></dt>
<dd><p class="first last">Incident intensity is set so that the median dR/R is equal
to <em>uncertainty</em>, where R is the idealized reflectivity
of the sample.</p>
</dd>
<dt><em>dLoL</em> = 0.02: float</dt>
<dd><p class="first last">Wavelength resolution</p>
</dd>
<dt><em>normalize</em> = True <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first last">Whether to normalize the intensities</p>
</dd>
<dt><em>theta_offset</em> = 0 <span class="classifier-delimiter">:</span> <span class="classifier">float | °</span></dt>
<dd><p class="first last">Sample alignment error</p>
</dd>
<dt><em>background</em> = 0 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Background counts per incident neutron (background is
assumed to be independent of measurement geometry).</p>
</dd>
<dt><em>back_reflectivity</em> = False <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first last">Whether beam travels through incident medium
or through substrate.</p>
</dd>
<dt><em>back_absorption</em> = 1 <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Absorption factor for beam traveling through substrate.
Only needed for back reflectivity measurements.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="initpop.html">refl1d.initpop - Population initialization strategies</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="magnetic.html">refl1d.magnetic - Magnetic Models</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2006-2011, Paul Kienzle, Nikunj Patel, James Krycka.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>
  </body>
</html>